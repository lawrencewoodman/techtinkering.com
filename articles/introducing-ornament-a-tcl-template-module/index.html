<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <title>Introducing Ornament a Tcl Template Module</title>
  <meta name="description" content="Ornament is a Tcl template module that allows you to define, parse and compile a template to produce a script which can then be run using a safe interpreter.  Th">
  <meta name="keywords" content="Retro Vintage Programming Tinkering"/>

  <!-- *** Twitter Card *** -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@techtinkering">
  <meta name="twitter:title" content="Introducing Ornament a Tcl Template Module">
  <meta name="twitter:description" content="Ornament is a Tcl template module that allows you to define, parse and compile a template to produce a script which can then be run using a safe interpreter.  Th">
    <meta name="twitter:image"
         content="https://techtinkering.com/img/social_images/stpetersburg_isaac_kathedrahle.jpg">
  <!-- *** Twitter Card *** -->

  <!-- *** Open Graph *** --->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Introducing Ornament a Tcl Template Module">
  <meta property="og:description" content="Ornament is a Tcl template module that allows you to define, parse and compile a template to produce a script which can then be run using a safe interpreter.  Th">
  <meta property="og:url" content="https://techtinkering.com/articles/introducing-ornament-a-tcl-template-module/">
    <meta property="og:image"
         content="https://techtinkering.com/img/social_images/stpetersburg_isaac_kathedrahle.jpg">
  <!-- *** Open Graph *** --->

  <script>
    console.log('timeZone: '+Intl.DateTimeFormat().resolvedOptions().timeZone);
    function isUserFromUK() {
      return Intl.DateTimeFormat().resolvedOptions().timeZone == "Europe/London";
    }
  </script>

  <link href="/css/main.css" rel="stylesheet">
  <link href="/css/article.css" rel="stylesheet">
  <link rel="canonical" href="https://techtinkering.com/articles/introducing-ornament-a-tcl-template-module/">
  <link rel="alternate" type="application/atom+xml" title="TechTinkering - Retro Computers, Programming, General Technical Tinkering"
        href="https://techtinkering.com/feed.xml" />

	<!-- ****** faviconit.com favicons ****** -->
	<link rel="shortcut icon" href="/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
	<!-- ****** faviconit.com favicons ****** -->

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

</head>
  <body>
    <nav>
  <div class="container">
    <div class="navbar-header">
      <a href="/">TechTinkering</a><br />
      =============
    </div>

    <div class="contact">
      <ul>
        <li>
          <a href="https://twitter.com/TechTinkering" title="@TechTinkering on Twitter">Twitter</a>
        </li>
        <li>
          <a href="https://youtube.com/techtinkering" title="TechTinkering's YouTube Channel">YouTube</a>
        </li>
        <li>
          <a href="/feed.xml" title="Subscribe to our Atom Feed">Feed</a>
        </li>
        <li>
          <a href="mailto:techtinkeringuk@gmail.com" title="Email us, we'd love to hear from you">Email</a>
        </li>
        <li>
          <a href="/useful-links/" title="Useful vintage computer links">Useful Links</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div id="content" class="container">
      <div class="margin-buffer">
    <article itemscope itemtype="http://schema.org/BlogPosting">
    <meta itemprop="image"
         content="https://techtinkering.com/img/social_images/stpetersburg_isaac_kathedrahle.jpg" />
      <header>
        <a href="/articles/introducing-ornament-a-tcl-template-module/" title="Introducing Ornament a Tcl Template Module">
          <h1 itemprop="headline name">Introducing Ornament a Tcl Template Module</h1>
        </a>
        <div>
            <time itemprop="datePublished"
                  datetime="2019-01-02">
               2 January 2019
            </time>
          <span itemscope itemprop="publisher"
                itemtype="http://schema.org/Organization">
            <meta itemprop="name" content="TechTinkering" />
            <meta itemprop="url" content="https://techtinkering.com" />
          </span>
          <span itemscope itemprop="author" itemtype="http://schema.org/Person">
            <a rel="author" itemprop="url" href="https://lawrencewoodman.github.io">
              <span itemprop="name">Lawrence Woodman</span>
            </a>
          </span>

          <ul class="tags">
              <li>#<a href="/articles/tag/ornament/">Ornament</a></li>
              <li>#<a href="/articles/tag/programming/">Programming</a></li>
              <li>#<a href="/articles/tag/tcl/">Tcl</a></li>
          </ul>
        </div>
      </header>

        <div itemprop="articleBody">
        <p>Ornament is a Tcl template module that allows you to define, parse and compile a template to produce a script which can then be run using a safe interpreter.  The idea came from the <a href="https://wiki.tcl.tk/18455">Templates and subst</a> page of the <a href="https://wiki.tcl.tk">Tclers Wiki</a>.</p>
<h2>Ornament on GitHub</h2>
<p>Ornament is licensed under an MIT licence and there is a <a href="https://github.com/lawrencewoodman/ornament_tcl">repo</a> on GitHub, from which you can download Ornament and where you can contribute to it.  There is also an <a href="https://github.com/lawrencewoodman/ornament_tcl/issues">issues tracker</a> where you can report bugs.</p>
<h2>Module Commands</h2>
<p>Ornament has two commands:</p>
<dl>
  <dt><code>compile</code></dt>
  <dd>Takes a template and outputs a script to be evaluated with <code>run</code></dd>
  <dt><code>run</code></dt>
  <dd>Takes a script created with <code>compile</code> and evaluates it using a safe interpreter to create its final output.</dd>
</dl>
<h2>Usage</h2>
<p>You control <em>ornament</em> using a <code>commandChar</code> in the first column of a line, this defaults to <code>!</code>.  If you want to change the <code>commandChar</code> you can do so using the <code>commandChar</code> followed by <code>*</code>.</p>
<pre><code class="language-tcl">!# This is a command
!* commandChar %
%# commandChar is now %, so we have to use %# as a comment
%* commandChar !
!# Now we are back to where we started
</code></pre>
<br />
<p>The following Tcl script demonstrates how to use <em>ornament</em>.</p>
<pre><code class="language-tcl">package require ornament
namespace import ornament::*

# This is the template
set tpl {
!# You can configure ornament the defaults are:
!#    commandChar     !
!#    commandSubst    false
!#    variableSubst   false
!#    backslashSubst  false
!* commandSubst true variableSubst true backslashSubst true
!#
This is some normal text
!# This is a comment and is ignored by `compile`
!# The following line will be executed as it begins with a `!` followed by a space
! for {set i 0} {$i &lt; 5} {incr i} {
    Number: $i
! }

!# You can also use `!!` followed by a space instead of a `!`
!! set flow 152
flow: $flow

!# You can use `\` at the end of a line beginning with `!` or `!!` to
!# continue it
! set nums [list 1 2 \
                 3 4]
nums: $nums

!# Alternatively you can continue a line using `!\` at the start
!\ set letters [list a b
!                    c d]
letters: $letters

 ! Because the ! wasn't in the first column of the line, this line isn't executed
!# Below some variables are used that have been passed to the template:
Name: $name
Age: $age
!# Below a command is called that has been passed to the template:
I want to say: [greet $name]

!# You can change the command character to anyone of {! % @ ~}
!* commandChar %
% set nextAge [expr {$age + 2}]
nextAge: $nextAge
%* commandChar !

!# You can change whether variable substitution happens
!* variableSubst false
look at this: $nextAge
!* variableSubst true
and now: $nextAge

!# You can change whether command substitution happens
!* commandSubst false
look at this: [expr {5 + 6}]
!* commandSubst true
and now: [expr {5 + 6}]

!# You can change whether backslash substitution happens
!* backslashSubst false
look at this:\n
!* backslashSubst true
and now:\n
}


# int is the safe interpreter that is running the script
proc CmdGreet {greeting int name} {
  return &quot;$greeting $name&quot;
}

# You can pass commands to the template
set cmds [dict create greet [list CmdGreet &quot;hello&quot;]]

# You can pass variables to the template
set vars [dict create name Brodie age 37]

set script [compile $tpl]
puts [run $script $cmds $vars]
</code></pre>
<br />
<p>The script above gives the following output.</p>
<pre><code>This is some normal text
    Number: 0
    Number: 1
    Number: 2
    Number: 3
    Number: 4

flow: 152

nums: 1 2 3 4

letters: a b c d

 ! Because the ! wasn't in the first column of the line, this line isn't executed
Name: Brodie
Age: 37
I want to say: hello Brodie

nextAge: 39

look at this: $nextAge
and now: 39

look at this: [expr {5 + 6}]
and now: 11

look at this:\n
and now:
</code></pre>
      </div>
    </article>
</div>

  <div id="cclicence">
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
      <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
    </a>
    <br />
    <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Introducing Ornament a Tcl Template Module</span>
    by <a xmlns:cc="http://creativecommons.org/ns#" href="https://techtinkering.com/articles/introducing-ornament-a-tcl-template-module/" property="cc:attributionName" rel="cc:attributionURL">Lawrence Woodman</a>
   is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
   
  </div>


  <div class="discuss">
    <h2 style="margin-top:0;">Share This Post</h2>
    <div class="contact">
  <ul>
    <li><a href="http://www.reddit.com/submit?url=https%3A%2F%2Ftechtinkering.com%2Farticles%2Fintroducing-ornament-a-tcl-template-module%2F&title=Introducing%20Ornament%20a%20Tcl%20Template%20Module" target="_blank" title="Submit to Reddit">Reddit</a></li>
    <li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftechtinkering.com%2Farticles%2Fintroducing-ornament-a-tcl-template-module%2F&quote=Introducing%20Ornament%20a%20Tcl%20Template%20Module" target="_blank" title="Share on Facebook">Facebook</a></li>
    <li><a href="https://twitter.com/intent/tweet?source=https%3A%2F%2Ftechtinkering.com%2Farticles%2Fintroducing-ornament-a-tcl-template-module%2F&text=Introducing%20Ornament%20a%20Tcl%20Template%20Module:%0Ahttps%3A%2F%2Ftechtinkering.com%2Farticles%2Fintroducing-ornament-a-tcl-template-module%2F&via=TechTinkering" target="_blank" title="Tweet">Twitter</a></li>
    <li><a href="mailto:?subject=Introducing%20Ornament%20a%20Tcl%20Template%20Module&body=Ornament%20is%20a%20Tcl%20template%20module%20that%20allows%20you%20to%20define%2C%20parse%20and%20compile%20a%20template%20to%20produce%20a%20script%20which%20can%20then%20be%20run%20using%20a%20safe%20interpreter.%20%20The%20idea%20came%20from%20the%20Templates%20and%20subst...:%0A%0Ahttps%3A%2F%2Ftechtinkering.com%2Farticles%2Fintroducing-ornament-a-tcl-template-module%2F" target="_blank" title="Send email">Email</a></li>
  </ul>
</div>

    <h2>Feedback/Discuss</h2>
    <div class="contact">
  <ul>


    <li><a href="mailto:techtinkeringuk@gmail.com?subject=Comment:%20Introducing%20Ornament%20a%20Tcl%20Template%20Module&body=Article%20URL:%20https%3A%2F%2Ftechtinkering.com%2Farticles%2Fintroducing-ornament-a-tcl-template-module%2F%0A" title="Send us an email">Email</a></li>
  </ul>
</div>
  </div>


    <div>
    <h2>Related Articles</h2>
    <div class="margin-buffer">
      <header>
  <h2><a href="/2013/02/27/xdgbasedir-a-tcl-module-to-access-the-xdg-base-directory-specification/">xdgbasedir: A Tcl Module to Access the XDG Base Directory Specification</a></h2>
  <span class="post-meta">
      <ul class="tags">
          <li>#<a href="/articles/tag/programming/">Programming</a></li>
          <li>#<a href="/articles/tag/tcl/">Tcl</a></li>
      </ul>
  </span>
</header>
<div>
  Unix has traditionally lacked a consistent way of storing user specific and system wide configuration and support files.  This has lead to a mess of dot files in a user's home directory and other assoc...
  &nbsp;
  <a class="readMore" href="/2013/02/27/xdgbasedir-a-tcl-module-to-access-the-xdg-base-directory-specification/">Read More</a>
</div>
<br />
      <header>
  <h2><a href="/2013/02/20/compiling-a-tcl-script-into-an-executable/">Compiling a Tcl Script into an Executable</a></h2>
  <span class="post-meta">
      <ul class="tags">
          <li>#<a href="/articles/tag/c/">C</a></li>
          <li>#<a href="/articles/tag/programming/">Programming</a></li>
          <li>#<a href="/articles/tag/tcl/">Tcl</a></li>
      </ul>
  </span>
</header>
<div>
  Locating Tcl scripts to load from an executable can be awkward if you want to make your program cross-platform.  An easier way is to compile a Tcl script directly into the executable and let that scrip...
  &nbsp;
  <a class="readMore" href="/2013/02/20/compiling-a-tcl-script-into-an-executable/">Read More</a>
</div>
<br />
      <header>
  <h2><a href="/2012/06/26/embedding-an-sdl-surface-in-a-tk-window/">Embedding an SDL Surface in a Tk Window</a></h2>
  <span class="post-meta">
      <ul class="tags">
          <li>#<a href="/articles/tag/programming/">Programming</a></li>
          <li>#<a href="/articles/tag/sdl/">SDL</a></li>
          <li>#<a href="/articles/tag/tcl/">Tcl</a></li>
          <li>#<a href="/articles/tag/tk/">Tk</a></li>
      </ul>
  </span>
</header>
<div>
  Tk is great, but sometimes it just isn't fast enough.  SDL is fast, but has no support for input dialogs and other GUI conventions.  By embedding an SDL surface in a Tk window you get the best of both ...
  &nbsp;
  <a class="readMore" href="/2012/06/26/embedding-an-sdl-surface-in-a-tk-window/">Read More</a>
</div>
<br />
      <header>
  <h2><a href="/articles/modula-2-compilers-on-cpm/">Modula-2 Compilers on CP/M</a></h2>
  <span class="post-meta">
      <ul class="tags">
          <li>#<a href="/articles/tag/cpm/">CP/M</a></li>
          <li>#<a href="/articles/tag/modula-2/">Modula-2</a></li>
          <li>#<a href="/articles/tag/programming/">Programming</a></li>
          <li>#<a href="/articles/tag/retro/">Retro</a></li>
      </ul>
  </span>
</header>
<div>
  Modula-2 is a great language in general and is a good choice for programming on CP/M.  There are three good compilers available for CP/M which all require a Z80 processor and we'll compare each in turn...
  &nbsp;
  <a class="readMore" href="/articles/modula-2-compilers-on-cpm/">Read More</a>
</div>
<br />
      <header>
  <h2><a href="/articles/is-subleq-the-right-choice-for-a-vm/">Is SUBLEQ the Right Choice for a VM?</a></h2>
  <span class="post-meta">
      <ul class="tags">
          <li>#<a href="/articles/tag/programming/">Programming</a></li>
          <li>#<a href="/articles/tag/subleq/">SUBLEQ</a></li>
      </ul>
  </span>
</header>
<div>
  SUBLEQ is an interesting architecture because of its simplicity, adaptability and power.  It is therefore an attractive choice for a simple virtual machine.  However, this comes at a cost which we will...
  &nbsp;
  <a class="readMore" href="/articles/is-subleq-the-right-choice-for-a-vm/">Read More</a>
</div>
<br />
</div>
    </div>

    </div>

    <footer>
  <nav>
    <div class="container">
      <div>
        <strong>Legal:</strong>
        <a href="/terms/">T & C</a>, <a href="/privacy/">Privacy Policy</a>
        &nbsp;
        <strong>Misc:</strong>
        <a href="https://github.com/lawrencewoodman/techtinkering.com" title="Fork TechTinkering On GitHub ">GitHub</a>
      </div>
    </div>
  </nav>
</footer>
  </body>
</html>